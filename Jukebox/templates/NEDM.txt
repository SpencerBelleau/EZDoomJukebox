#library "NEDM"
#include "zcommon.acs"

<<MUSICSTRINGS>>
<<MUSICNAMES>>
<<MUSICLENGTHS>>
int tracks = <<NUMTRACKS>>;

script "NEDM" OPEN
{
	int tracknum = -1;
	int oldtrackNum = 0;
	int delaytimer = 1; //let's do a tiny bit more error checking
	while(1)
	{
		//Patented retard logic to avoid replays
		if(tracknum == -1 && tracks > 1)
		{
			tracknum = random(0, tracks - 1);
		}
		else if(tracks > 1)
		{
			oldtrackNum = tracknum;
			while(tracknum == oldtrackNum)
			{
				tracknum = random(0, tracks - 1);
			}
		}
		else
		{
			//you only got one song son wtf
			tracknum = 0;
		}
		SetFont("CONFONT");
		//improve this later, maybe with more templating
		HudMessage(	s:"NOW PLAYING: ", s:songRealNames[tracknum];
					HUDMSG_PLAIN, 
					3485, //random to avoid collision
					CR_GREEN,
					0.5,
					0.0,
					2.0);
		SetMusic(songNames[tracknum], 0);
		delaytimer = durations[tracknum] * 35;
		if(delaytimer == 0)
			delaytimer = 1;
		delay(delaytimer);
	}
}